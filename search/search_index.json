{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Shifter","text":"<p>Self-service cyber range platform for PANW SecOps Domain Consultants.</p>"},{"location":"#what-it-does","title":"What It Does","text":"<ul> <li>Browser-based Kali desktop with Cursor IDE</li> <li>Dynamically provisioned victim infrastructure</li> <li>AI-driven vulnerability deployment and attack simulation</li> <li>XDR/XSIAM detection testing</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>Architecture</li> <li>Setup</li> <li>API Reference</li> </ul>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#mcp-tools","title":"MCP Tools","text":""},{"location":"api/#victim_run_command","title":"victim_run_command","text":"<p>Execute command on victim instance.</p> <p>Parameters: - <code>command</code> (string): Command to execute - <code>timeout_seconds</code> (number, optional): Timeout in seconds</p> <p>Returns: Command output</p>"},{"location":"api/#victim_interactive_session","title":"victim_interactive_session","text":"<p>Create persistent SSH session to victim.</p> <p>Parameters: - <code>session_name</code> (string): Identifier for session</p> <p>Returns: Session ID</p>"},{"location":"api/#list_sessions","title":"list_sessions","text":"<p>List active SSH sessions.</p> <p>Returns: Array of session info</p>"},{"location":"api/#close_session","title":"close_session","text":"<p>Close SSH session.</p> <p>Parameters: - <code>session_id</code> (string): Session to close</p>"},{"location":"api/#get_session_output","title":"get_session_output","text":"<p>Retrieve output from session.</p> <p>Parameters: - <code>session_id</code> (string): Session ID - <code>timeout_ms</code> (number, optional): Wait timeout</p> <p>Returns: Accumulated output</p>"},{"location":"architecture/","title":"Architecture","text":""},{"location":"architecture/#infrastructure-overview","title":"Infrastructure Overview","text":"<p>Two isolated network domains:</p> <ul> <li>Portal: Shared infra running Django, RDS. Single VPC.</li> <li>Range: Per-user ephemeral VPCs with Kasm jumpbox and victim instances.</li> </ul> <pre><code>graph TB\n    subgraph \"Portal VPC\"\n        Portal[Django Portal]\n        RDS[(PostgreSQL)]\n        Portal --&gt; RDS\n    end\n\n    subgraph \"Range VPC (per-user)\"\n        Kasm[Kasm Jumpbox]\n        Victim[Victim Instance]\n        Kasm --&gt;|SSH/MCP| Victim\n    end\n\n    User((User)) --&gt;|HTTPS| Portal\n    Portal --&gt;|Provisions| Kasm\n    Victim --&gt;|Telemetry| XDR[XDR/XSIAM]</code></pre>"},{"location":"architecture/#portal-infrastructure","title":"Portal Infrastructure","text":""},{"location":"architecture/#network","title":"Network","text":"<pre><code>graph TB\n    subgraph \"Portal VPC (10.0.0.0/16)\"\n        subgraph \"Public Subnets (2 AZs)\"\n            NAT[NAT Gateway]\n        end\n        subgraph \"Private Subnets (2 AZs)\"\n            ECS[Django on ECS]\n            RDS[(RDS PostgreSQL)]\n        end\n        ECS --&gt; RDS\n        ECS --&gt; NAT\n    end\n    NAT --&gt; Internet((Internet))</code></pre> <p>Two AZs required for RDS subnet group. Single NAT gateway for cost optimization.</p>"},{"location":"architecture/#components","title":"Components","text":"Component Purpose ECR Container registry for Django image VPC Network isolation, public/private subnet separation RDS PostgreSQL 16, encrypted, credentials in Secrets Manager"},{"location":"architecture/#secrets-management","title":"Secrets Management","text":"<p>RDS credentials auto-generated at provision time, stored in Secrets Manager. Secret configured with <code>recovery_window_in_days = 0</code> to allow immediate deletion and avoid naming conflicts on destroy/recreate cycles.</p>"},{"location":"architecture/#range-infrastructure-todo","title":"Range Infrastructure (TODO)","text":"<p>Per-user ephemeral VPCs provisioned via Step Functions when user launches a range.</p> <p>Contains:</p> <ul> <li>Kasm container (Kali + Cursor + MCP)</li> <li>Victim EC2 instance with user's XDR agent</li> </ul> <p>Isolated from portal VPC. No peering.</p>"},{"location":"architecture/#deployment-pipeline","title":"Deployment Pipeline","text":"<p>GitHub Actions deploys via Terraform on merge to main.</p> <pre><code>graph LR\n    Push[Push to main] --&gt; GHA[GitHub Actions]\n    GHA --&gt;|OIDC| AWS[AWS]\n    GHA --&gt;|terraform apply| Infra[Infrastructure]</code></pre> <p>IAM via OIDC federation. No static credentials. Role permissions scoped to shifter-* resources.</p>"},{"location":"architecture/#secrets-sync","title":"Secrets Sync","text":"<p>Terraform variables stored locally in <code>.tfvars</code> files (gitignored). Synced to GitHub secrets before PR:</p> <pre><code>./scripts/sync-tfvars.sh\n</code></pre> <p>Creates namespaced secrets: <code>TF_VARS_{ENV}_{COMPONENT}</code> (e.g., <code>TF_VARS_PROD_PORTAL</code>).</p>"},{"location":"architecture/#two-context-pattern","title":"Two-Context Pattern","text":"<p>MCP enables AI-driven scenario setup:</p> <ol> <li>Setup chat: Configure vulnerability on victim (defender context)</li> <li>Attack chat: Exploit victim from Kasm (attacker context, no memory of setup)</li> </ol> <p>XDR/XSIAM detects the attack, user demos to customer.</p>"},{"location":"setup/","title":"Setup","text":""},{"location":"setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Node.js 22.x</li> <li>Python 3.11+</li> <li>Terraform 1.14+</li> <li>AWS CLI configured with SSO</li> <li>GitHub CLI (<code>gh</code>) for secrets sync</li> </ul>"},{"location":"setup/#infrastructure-deployment","title":"Infrastructure Deployment","text":""},{"location":"setup/#first-time-setup","title":"First-Time Setup","text":"<ol> <li> <p>Configure AWS SSO and login:    <pre><code>aws sso login\n</code></pre></p> </li> <li> <p>Create <code>terraform.tfvars</code> from example:    <pre><code>cp terraform/environments/prod/portal/terraform.tfvars.example \\\n   terraform/environments/prod/portal/terraform.tfvars\n</code></pre></p> </li> <li> <p>Fill in values, then sync to GitHub secrets:    <pre><code>./scripts/sync-tfvars.sh\n</code></pre></p> </li> <li> <p>Push branch and create PR. GitHub Actions runs <code>terraform plan</code>.</p> </li> <li> <p>Merge to main. GitHub Actions runs <code>terraform apply</code>.</p> </li> </ol>"},{"location":"setup/#manual-deployment","title":"Manual Deployment","text":"<p>Via workflow dispatch in GitHub Actions, or locally:</p> <pre><code>cd terraform/environments/prod/portal\nterraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"setup/#mcp-development","title":"MCP Development","text":""},{"location":"setup/#aptl-mcp-common","title":"aptl-mcp-common","text":"<pre><code>cd mcp/aptl-mcp-common\nnpm install\nnpm run build\nnpm test -- --coverage\n</code></pre>"},{"location":"setup/#mcp-red","title":"mcp-red","text":"<pre><code>cd mcp/mcp-red\nnpm install\nnpm run build\nnpx @modelcontextprotocol/inspector build/index.js\n</code></pre>"},{"location":"setup/#documentation","title":"Documentation","text":""},{"location":"setup/#local-preview","title":"Local Preview","text":"<pre><code>pip install -r requirements-docs.txt\nmkdocs serve\n</code></pre> <p>Browse to <code>http://127.0.0.1:8000</code></p>"},{"location":"setup/#deploy-to-github-pages","title":"Deploy to GitHub Pages","text":"<p>Automatic via GitHub Actions on push to <code>main</code>.</p>"}]}